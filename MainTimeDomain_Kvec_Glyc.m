%declare global
clear
global Kvec Uini DX G GroupIndices
load('ModelChimeric_Glycolysis ResultsNoMetabRemove')





%% Analyze
NoEnzymes = length(EnzName);

Xini = zeros(length(X),1);
Uini = ones(length(U),1);

T_Rxn = 250;
%Vm_min = 0.5;
%Vm_max = 1.5;
%Keq = 1;
%Km_min = 0.1;
%Km_max = 1;
%log10_min = -4;
%log10_max = 1;
%steps = 100;
%EnzChange = 'Xpk';
%EnzInd=find(ismember(EnzName,EnzChange));

FinalMetabs = Net.MetabName
%FinalMetabs(ToRemove, :) = []

for U_step = [0.5 1 2]

Uini(11,1) = U_step;
    
Xini(find(ismember(FinalMetabs,'Glc')),1) = 1;
Xini(find(ismember(FinalMetabs,'Pyr')),1) = 2;
Xini(find(ismember(FinalMetabs,'3PG')),1) = 2;
Xini(find(ismember(FinalMetabs,'ATP')),1) = 2;
Xini(find(ismember(FinalMetabs,'ADP')),1) = 2;
Xini(find(ismember(FinalMetabs,'NAD')),1) = 10;
Xini = Xini * 2

%Kvec = [100.727083148532;9.10092141519359;8.97206878542990;3.35840924460834;9.98570059237912;1.75751879110919;6.64296040104800;93.4218284386236;9.87681405821500;7.58908021582518;7.19437335268616;8.12481383110014;3.08604065890532;9.13214910801788;1.81650833145898;3.50271054032932;7.22279847875286;1.70639035728261;5.48029769673523;14.7503380834450;9.03168553537411;0.277080434295735;3.91549216476283;7.22079901284398;9.43914216941682;18.4704037814390;8.42702828256620;6.13389570077724;6.10092855695847;20.7164642765873;6.78449650664823;7.04912047138856;9.01005705437779;178.567821412689;8.23875646141853;8.66406150862380;55.2916511499819;9.88681332635876;1.53938638849037;16.9428145408271;9.69581741278986;9.19178933642058;1.83703894373687;2;]';
Kvec = [92.4851570959490;8.82139262552433;8.41670500531604;7.11079575396918;8.17790441652806;3.36274661718919;1.79008904373050;10.8768465420819;1.24043586695183;3.85479040151241;32.0828987852125;4.35603372446686;5.08523428953747;2.29378487616597;0.444834394296718;13.7989584593431;6.08085455733592;7.15538058768812;2.12053292555741;64.2498357486260;8.40573374741700;6.17223061092782;1.80485732314524;2.69928969348835;3.76123740434755;36.7420579946454;1.64358606520677;4.85476709073373;3.62605685916823;29.5348486720744;2.61899763919105;7.27868770201127;8.56157134625250;73.3819923626713;4.35149714273880;5.85621148674627;61.3295591161851;9.85057044891314;1.82609837911003;11.8221855615925;8.67975209062568;5.91663965775679;1.66971437352095;2;]';
Kvec([44]) = 0;

    [Time,X_out]=ode15s('dxdt',[0 T_Rxn],Xini);
    %[uf, conc1, Bif1] = SimpleODESolver(StepsUp, Xini, U, Uf1, Kvec,DVDX, DVDU,S,JACOBIAN );

Results{1 + (U_step > 0.6) + (U_step > 1.1)} = [Time X_out];
end
